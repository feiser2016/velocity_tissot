--- fs/xfs/xfs_acl.c
+++ fs/xfs/xfs_acl.c
@@ -286,11 +286,16 @@ xfs_set_acl(struct inode *inode, struct posix_acl *acl, int type)
 		return error;
 
 	if (type == ACL_TYPE_ACCESS) {
-		umode_t mode;
+		umode_t mode = inode->i_mode;
+		error = posix_acl_equiv_mode(acl, &mode);
+
+		if (error <= 0) {
+			acl = NULL;
+
+			if (error < 0)
+				return error;
+		}
 
-		error = posix_acl_update_mode(inode, &mode, &acl);
-		if (error)
-			return error;
 		error = xfs_set_mode(inode, mode);
 		if (error)
 			return error;
